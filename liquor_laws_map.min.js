// Code by Patty Alice Jiang https://www.github.com/becausealice2/FA-viz/liquor_laws/tree/master/liquor_laws
function create_config(t){t.toString().split("\n").forEach(function(t){if(""!=t){var e=(t=t.split(":"))[0].trim().toLowerCase(),o=t[1].trim();config[e]=o}}),redraw(config)}function redraw(t){d3.json("https://"+t.map_location,function(e){var o=e.objects.countries,n=o.bbox,r=(n[2]-n[0])/(n[3]-n[1]),a=document.getElementById(t.div_id).clientWidth,i=a/r,c={top:parseFloat(t.margin_top),bottom:parseFloat(t.margin_bottom),left:parseFloat(t.margin_left),right:parseFloat(t.margin_right)},l=d3.select("#"+t.div_id).append("svg").attr("viewBox",c.top+" "+c.left+" "+(a-c.right)+" "+(i-c.bottom)).attr("preserveAspectRatio","xMidYMid meet").append("g").attr("class",t.div_id),p=d3.geoEquirectangular().scale(t.map_scale).translate([a/t.map_shift_horizontal,i/t.map_shift_vertical]),s=d3.geoPath().projection(p),e=topojson.feature(e,o);d3.csv("https://"+t.reviews_location,function(o){l.append("g").attr("class",t.div_id+"_countries").selectAll("path").data(e.features).enter().append("path").attr("d",s).style("fill",t.country_fill_color).style("stroke",t.country_border_color).style("stroke-width",t.country_border_width);var n=t.reviews_longitude_column,r=t.reviews_latitude_column;l.selectAll("circle").data(o).enter().append("circle").attr("cx",function(t){return p([t[n],t[r]])[0]}).attr("cy",function(t){return p([t[n],t[r]])[1]}).attr("r",parseFloat(t.location_marker_radius)).style("fill",t.location_marker_color)})})}!function(){if(Event.prototype.preventDefault||(Event.prototype.preventDefault=function(){this.returnValue=!1}),Event.prototype.stopPropagation||(Event.prototype.stopPropagation=function(){this.cancelBubble=!0}),!Element.prototype.addEventListener){var t=[],e=function(e,o){var n=this,r=function(t){t.target=t.srcElement,t.currentTarget=n,void 0!==o.handleEvent?o.handleEvent(t):o.call(n,t)};if("DOMContentLoaded"==e){var a=function(t){"complete"==document.readyState&&r(t)};if(document.attachEvent("onreadystatechange",a),t.push({object:this,type:e,listener:o,wrapper:a}),"complete"==document.readyState){var i=new Event;i.srcElement=window,a(i)}}else this.attachEvent("on"+e,r),t.push({object:this,type:e,listener:o,wrapper:r})},o=function(e,o){for(var n=0;n<t.length;){var r=t[n];if(r.object==this&&r.type==e&&r.listener==o){"DOMContentLoaded"==e?this.detachEvent("onreadystatechange",r.wrapper):this.detachEvent("on"+e,r.wrapper),t.splice(n,1);break}++n}};Element.prototype.addEventListener=e,Element.prototype.removeEventListener=o,HTMLDocument&&(HTMLDocument.prototype.addEventListener=e,HTMLDocument.prototype.removeEventListener=o),Window&&(Window.prototype.addEventListener=e,Window.prototype.removeEventListener=o)}}();var config={},topology="",reviews="",width=0,height=0,svg=null,projection=null,path=null;d3.text("./config.txt",create_config);
